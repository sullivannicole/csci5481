# Databricks notebook source
# MAGIC %r
# MAGIC
# MAGIC install.packages("ape")

# COMMAND ----------

# MAGIC %r
# MAGIC library(ape)
# MAGIC options(repr.plot.width = 2500, repr.plot.height = 2500)

# COMMAND ----------

# MAGIC %r
# MAGIC
# MAGIC ex_tree <- read.tree(text = "(Taxon_6:0.039473684210526355,Taxon_7:0.06578947368421048,((Taxon_1:0.430921052631579,(Taxon_4:0.08947368421052637,Taxon_5:0.06842105263157894)12:0.0953947368421052)11:0.1348684210526316,(Taxon_2:0.1469298245614035,Taxon_3:0.06359649122807018)10:0.10855263157894737)9:0.07565789473684212)8;")
# MAGIC plot.phylo(ex_tree, "f", font = 1)

# COMMAND ----------

# MAGIC %r
# MAGIC
# MAGIC # Visualize
# MAGIC ex_tree <- read.tree(text = "(Taxon_54:0.08232040713324361,(((Taxon_40:0.06103844212651409,(Taxon_4:0.06972761398048455,(Taxon_6:0.07590111877523553,Taxon_7:0.07416617597577391)97:0.005306033395020171)105:0.01786465343203232)108:0.003225655359109264,(Taxon_43:0.07453068921040824,(Taxon_39:0.08645132346343651,Taxon_57:0.06630776132794972)106:0.06409649786899956)109:0.0047445667135690706)110:0.07891402302327422,((Taxon_5:0.08706305144309859,Taxon_35:0.022290918947210997)76:0.0815357016361899,(((Taxon_31:0.04100326451132561,Taxon_42:0.03975043669997993)74:0.07702662408675756,(Taxon_8:0.03393079728985684,Taxon_47:0.07407727808026429)77:0.004147669318356834)94:0.08187786220381107,((Taxon_10:0.08640797590663904,((Taxon_44:0.09427864985657615,Taxon_55:0.11769981582310078)93:0.04869637942410414,(Taxon_52:0.083332153787918,(Taxon_9:0.08168050615266291,Taxon_59:0.07578921120938283)65:0.0801940911649757)95:-0.007310107553310036)96:0.027020358140824777)107:0.08375589191886865,(((Taxon_34:0.009382917029530514,Taxon_51:0.09526042079011957)104:0.07606234578286225,(Taxon_48:0.11089438930013462,((((Taxon_37:0.07917059219380891,Taxon_56:0.08839333781965002)71:0.0942365486969289,(Taxon_38:0.10357722804143014,(Taxon_41:0.047610122008309406,(Taxon_32:0.04777102631092817,Taxon_58:0.04105804502150794)70:0.043910739364503494)75:0.06735143952249985)98:-0.007089846139728372)99:0.10129752691790042,(Taxon_30:0.05707235787989491,Taxon_49:0.048580401204896526)100:-0.0028789535666217878)101:0.06431205136832657,(Taxon_61:0.061962084720549704,(Taxon_12:0.07193211596952757,(Taxon_13:0.07134351563485763,(Taxon_14:0.07009812173150684,(Taxon_15:0.07153219425822652,((Taxon_16:0.047646454629170484,Taxon_33:0.033780194092229224)64:0.06979450148195027,(Taxon_17:0.06935463800310251,(Taxon_18:0.06794655625120175,(Taxon_19:0.06891629455940633,(Taxon_20:0.06916503639827584,((Taxon_45:0.09471882922783194,((Taxon_22:0.02569421519083772,Taxon_27:0.017374425455191835)68:0.05240664570000276,(Taxon_26:0.01851899782586186,(Taxon_21:0.022285155276406957,Taxon_23:0.023475275409999493)67:0.0013329537219173865)69:0.006812735188287976)72:0.035160040220351116)78:0.06970803707409509,((Taxon_24:0.03665285722296994,Taxon_25:0.029295998766262897)73:0.07918214230251584,((Taxon_28:0.03325584240792859,Taxon_60:0.027309433500550567)66:0.0696558504374159,(Taxon_29:0.07660830351574044,(Taxon_11:0.05924141190796638,Taxon_36:0.04775724219701339)79:-0.010491210648984034)80:-0.005221126345895034)81:0.011203120147013107)82:-0.006198615808953749)83:0.0026878825115492014)84:0.0025554626747794212)85:0.003069121322822478)86:0.003133769424555649)87:0.0022522841422085577)88:0.00031086702205612715)89:0.001839572792382796)90:0.0005934395668163103)91:-9.521252097577371e-07)92:0.06858973223772752)102:-0.010812724315836686)103:0.01191853129205922)111:-0.01919828117990132)112:0.07890760190348012,(Taxon_50:0.13958797737213993,(Taxon_3:0.1322486889126097,(Taxon_1:0.1155872892761822,Taxon_2:0.1246549718274517)62:0.021519817143917888)63:0.1849409593707941)113:-0.028783527206306468)114:0.002870327798493416)115:-0.002701381719288881)116:-0.003986050912541304)117:1.55886602593025e-06)118:0.046327817488165876,(Taxon_46:0.18967525025235524,Taxon_53:0.09296270398721404)119:0.006508664199192507)120;")
# MAGIC
# MAGIC plot.phylo(ex_tree, "f", font = 1)

# COMMAND ----------

# tree based distances
# get combos of edges in example

